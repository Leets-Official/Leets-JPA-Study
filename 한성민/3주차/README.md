ğŸ’¡ ëª©í‘œ: ê°ì²´ì˜ ì°¸ì¡°ì™€ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ë¥¼ ë§¤í•‘í•˜ëŠ” ê²ƒ

## ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„
- íšŒì›ì€ í•˜ë‚˜ì˜ íŒ€ì—ë§Œ ì†Œì†ë  ìˆ˜ ìˆë‹¤.
- íšŒì›ê³¼ íŒ€ì€ ë‹¤ëŒ€ì¼ ê´€ê³„ë‹¤.


- ê°ì²´ ì—°ê´€ê´€ê³„
    - íšŒì› ê°ì²´ì™€ íŒ€ ê°ì²´ëŠ” ë‹¨ë°©í–¥ ê´€ê³„.
    - Member.team í•„ë“œë¡œ íŒ€ ê°ì²´ì™€ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.
    - member -> teamì˜ ì¡°íšŒëŠ” ê°€ëŠ¥, ë°˜ëŒ€ëŠ” ë¶ˆê°€.
    
- í…Œì´ë¸” ì—°ê´€ê´€ê³„
  - íšŒì› í…Œì´ë¸”ì€ TEAM_ID ì™¸ë˜í‚¤ë¡œ íŒ€ í…Œì´ë¸”ê³¼ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.
  - íšŒì›ê³¼ íŒ€ í…Œì´ë¸”ì€ ì–‘ë°©í–¥ ê´€ê³„ (íšŒì›, íŒ€ ë‘˜ ë‹¤ ì¡°ì¸ ê°€ëŠ¥).

  
### ê°ì²´ ì—°ê´€ê´€ê³„ì™€ í…Œì´ë¸” ì—°ê´€ê´€ê³„ ì •ë¦¬

- ê°ì²´ëŠ” ì°¸ì¡°(ì£¼ì†Œ)ë¡œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.
    - ì°¸ì¡°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê°ì²´ì˜ ì—°ê´€ê´€ê³„ëŠ” ë‹¨ë°©í–¥ì´ë‹¤.
    - ê°ì²´ë¥¼ ì–‘ë°©í–¥ìœ¼ë¡œ ì°¸ì¡°í•˜ë ¤ë©´ ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ 2ê°œ ë§Œë“¤ì–´ì•¼ í•œë‹¤.
- í…Œì´ë¸”ì€ ì™¸ë˜ í‚¤ë¡œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤.
    - ì™¸ë˜ í‚¤ë¥¼ ì‚¬ìš©í•˜ëŠ” í…Œì´ë¸”ì˜ ì—°ê´€ê´€ê³„ëŠ” ì–‘ë°©í–¥ì´ë‹¤.

  
### ê°ì²´ ê´€ê³„ ë§¤í•‘
- ë§¤í•‘í•œ íšŒì› ì—”í‹°í‹°
```java
@Entity
public class Member {

@Id
@GeneratedValue
@Column(name = "MEMBER_ID")
private Long id;

private String username;

// ì—°ê´€ê´€ê³„ ë§¤í•‘
@ManyToOne
@JoinColumn(name = "TEAM_ID")
private Team team;

// ì—°ê´€ê´€ê³„ ì„¤ì •
public void setTeam(Team team) {
this.team = team;
}
}
```

- ë§¤í•‘í•œ íŒ€ ì—”í‹°í‹°
```java
@Entity
public class Team {

@Id
@GeneratedValue(strategy = GenerationType.AUTO)
@Column(name = "TEAM_ID")
private Long id;

private String name;
}
```
- ê°ì²´ ì—°ê´€ê´€ê³„ : íšŒì› ê°ì²´ì˜ Member.team í•„ë“œ ì‚¬ìš©.
- í…Œì´ë¸” ì—°ê´€ê´€ê³„ : íšŒì› í…Œì´ë¸”ì˜ Member.TEAM_ID ì™¸ë˜ í‚¤ ì»¬ëŸ¼ ì‚¬ìš©.

### @JoinColumn : ì™¸ë˜ í‚¤ë¥¼ ë§¤í•‘í•  ë•Œ ì‚¬ìš©
| ì†ì„±                  | ê¸°ëŠ¥                                            | ê¸°ë³¸ê°’                       |
|-----------------------|-----------------------------------------------|------------------------------|
| name                  | ë§¤í•‘í•  ì™¸ë˜ í‚¤ ì´ë¦„                                   | í•„ë“œëª… _ ì°¸ì¡°í•˜ëŠ” í…Œì´ë¸” PK ì»¬ëŸ¼ëª… |
| referencedColumnName  | ì™¸ë˜ í‚¤ê°€ ì°¸ì¡°í•˜ëŠ” ëŒ€ìƒ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ëª…                        | ì°¸ì¡°í•˜ëŠ” í…Œì´ë¸”ì˜ PK ì»¬ëŸ¼ëª…  |
| foreignKey(DDL)       | ì™¸ë˜ í‚¤ ì œì•½ì¡°ê±´ì„ ì§ì ‘ ì§€ì •í•  ìˆ˜ ìˆë‹¤. <br> í…Œì´ë¸” ìƒì„±í•  ë•Œë§Œ ì‚¬ìš©í•œë‹¤. | í…Œì´ë¸” ìƒì„±í•  ë•Œë§Œ ì‚¬ìš©í•œë‹¤. |

### @ManyToOne : ë‹¤ëŒ€ì¼ ê´€ê³„ì—ì„œ ì‚¬ìš©
| ì†ì„±          | ê¸°ëŠ¥                                                        | ê¸°ë³¸ê°’                                     |
|---------------|-------------------------------------------------------------|--------------------------------------------|
| optional      | falseë¡œ ì„¤ì •í•˜ë©´ ì—°ê´€ëœ ì—”í‹°í‹°ê°€ í•­ìƒ ìˆì–´ì•¼ í•œë‹¤.          | true                                       |
| fetch         | ê¸€ë¡œë²Œ í˜ì¹˜ ì „ëµì„ ì„¤ì •í•œë‹¤.                                | - @ManyToOne=FetchType.EAGER <br> - @ManyToOne=FetchType.LAZY |
| cascade       | ì˜ì†ì„± ì „ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤.                                |                                            |
| targetEntity  | ì—°ê´€ëœ ì—”í‹°í‹°ì˜ íƒ€ì… ì •ë³´ë¥¼ ì„¤ì •í•œë‹¤. <br> ê±°ì˜ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. |                                            |
<hr>

## ì—°ê´€ê´€ê³„ ì‚¬ìš©
### ì €ì¥
```java
member1.setTeam(team1); // íšŒì› -> íŒ€ ì°¸ì¡°
em.persist(member1); // ì €ì¥
```

- íšŒì› ì—”í‹°í‹°ëŠ” íŒ€ ì—”í‹°í‹°ë¥¼ ì°¸ì¡°í•˜ê³  ì €ì¥í•œë‹¤.
- JPAëŠ” ì°¸ì¡°í•œ íŒ€ì˜ ì‹ë³„ì(Team_ID)ë¥¼ ì™¸ë˜ í‚¤ë¡œ ì‚¬ìš©í•´ì„œ ë“±ë¡ ì¿¼ë¦¬ë¥¼ ìƒì„±í•œë‹¤.

### ì¡°íšŒ
- ì—°ê´€ê´€ê³„ê°€ ìˆëŠ” ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•˜ëŠ” ë°©ë²•
1. ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰(ê°ì²´ ì—°ê´€ê´€ê³„ë¥¼ ì‚¬ìš©í•œ ì¡°íšŒ)
- member.getTeam()ì„ ì‚¬ìš©í•´ì„œ memberì™€ ì—°ê´€ëœ team ì—”í‹°í‹°ë¥¼ ì¡°íšŒí•œë‹¤.

```java
Member member = em.find(Member.class, "member1");
Team team = member.getTeam(); // ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰
```

2. ê°ì²´ì§€í–¥ ì¿¼ë¦¬ ì‚¬ìš©(JPQL)
```java
String jpql = "select m from Member m join m.team t where " + "t.name=:teamName";

List<Member> resultList = em.createQuery(jpql, Member.class)
.setParameter("teamName", "íŒ€1")
.getResultList();
```

### ìˆ˜ì •
```java
// ìƒˆë¡œìš´ íŒ€2
Team team2 = new Team("team2", "íŒ€2");
em.persist(team2);

// íšŒì›1ì— ìƒˆë¡œìš´ íŒ€2 ì„¤ì •
Member member = em.find(Member.class, "member1");
member.setTeam(team2);
```

- 3ì¥ì—ì„œ ì´ì•¼ê¸°í–ˆë“¯ì´ ë¶ˆëŸ¬ì˜¨ ì—”í‹°í‹° ê°’ë§Œ ë³€ê²½í•´ë‘ë©´ íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•  ë•Œ í”ŒëŸ¬ì‹œê°€ ì¼ì–´ë‚˜ë©´ì„œ ë³€ê²½ ê°ì§€ ê¸°ëŠ¥ì´ ì‘ë™í•œë‹¤.
- ë³€ê²½ì‚¬í•­ì„ dbì— ìë™ìœ¼ë¡œ ë°˜ì˜í•œë‹¤.

### ì—°ê´€ê´€ê³„ ì œê±° ë° ì—°ê´€ëœ ì—”í‹°í‹° ì‚­ì œ
```java
Member member1 = em.find(Member.class, "member1");

// ì—°ê´€ê´€ê³„ ì œê±°
member1.setTeam(null);

// ì—°ê´€ëœ ì—”í‹°í‹° ì‚­ì œ
em.remove(team);
```
<hr>

## ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„
### ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ë§¤í•‘
```java
@Entity
public class Team {

@Id
@GeneratedValue(strategy = GenerationType.AUTO)
@Column(name = "TEAM_ID")
private Long id;

private String name;

@OneToMany(mappedBy = "team")
private List<Member> members = new ArrayList<>();
}

```
### ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸

- í…Œì´ë¸”ì€ ì™¸ë˜ í‚¤ í•˜ë‚˜ë¡œ ë‘ í…Œì´ë¸”ì˜ ì—°ê´€ê´€ê³„ë¥¼ ê´€ë¦¬í•œë‹¤.
- í•˜ì§€ë§Œ, ê°ì²´ ì—°ê´€ê´€ê³„ëŠ” ì–‘ë°©í–¥ ê´€ê³„ë¥¼ ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„ 2ê°œë¡œ ê°ê° ë§Œë“ ë‹¤.
- ê°ì²´ì˜ ì°¸ì¡°ëŠ” ë‘˜ì¸ë° ì™¸ë˜ í‚¤ëŠ” í•˜ë‚˜ì¸ ì°¨ì´ê°€ ë°œìƒí•œë‹¤.
â†’  ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ : ë‘ ê°ì²´ ì—°ê´€ê´€ê³„ ì¤‘ í•˜ë‚˜ë¥¼ ì •í•´ì„œ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬í•˜ëŠ” ê²ƒ

â†’  ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ë§Œì´ ì™¸ë˜ í‚¤ë¥¼ ê´€ë¦¬(ë“±ë¡, ìˆ˜ì •, ì‚­ì œ)í•  ìˆ˜ ìˆë‹¤.

â†’  ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì€ ì™¸ë˜ í‚¤ê°€ ìˆëŠ” ê³³ìœ¼ë¡œ ì •í•´ì•¼ í•œë‹¤.

* mappedBy ì†ì„±

  * ì£¼ì¸ì€ mappedBy ì†ì„±ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
  * ì£¼ì¸ì´ ì•„ë‹ˆë©´ mappedByë¥¼ ì‚¬ìš©í•´ì„œ ì†ì„±ì˜ ê°’ìœ¼ë¡œ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì„ ì§€ì •í•´ì•¼ í•œë‹¤.
  
```java
class Team {

      // mappedBy ì†ì„±ì˜ ê°’ì€ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì¸ Member.team
      @OneToMany(mappedBy = "team") 
      private List<Member> members = new ArrayList<>();
      ...
  }
```
## ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ì €ì¥
```java
Team team1 = new Team("team1", "íŒ€1");
em.persist(team1);

Member member1 = new Member("member1", "íšŒì›1");
member1.setTeam(team1);
em.persist(member1);
```
ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„ì—ì„œ íšŒì›ê³¼ íŒ€ì„ ì €ì¥í•˜ëŠ” ì½”ë“œì™€ ì™„ì „íˆ ê°™ë‹¤.
ì™œëƒí•˜ë©´, ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì¸ Member.teamì—ì„œ ê´€ë¦¬í•˜ê¸° ë•Œë¬¸ì´ë‹¤.

### ì£¼ì˜ì 
```java
Team team1 = new Team("team1", "íŒ€1");

Member member1 = new Member("member1", "íšŒì›1");
em.persist(member1);

// ì£¼ì¸ì´ ì•„ë‹Œ ê³³ë§Œ ì—°ê´€ê´€ê³„ ì„¤ì •
team1.getMembers().add(member1);

em.persist(team1);
```
- Team.membersëŠ” ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ ì•„ë‹ˆê¸°ë•Œë¬¸ì— TEAM_ID ê°€ nullì´ ì…ë ¥ëœë‹¤.

â†’  ê°ì²´ ê´€ì ì—ì„œ ì–‘ìª½ ë°©í–¥ì— ëª¨ë‘ ê°’ì„ ì…ë ¥í•´ì£¼ëŠ” ê²ƒì´ ê°€ì¥ ì•ˆì „í•˜ë‹¤.

```java
Team team1 = new Team("team1", "íŒ€1");
em.persist(team1);

Member member1 = new Member("member1", "íšŒì›1");

// ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ ì„¤ì •
member1.setTeam(team1);
team1.getMembers().add(member1);
em.persist(member1);
```

### ì •ë¦¬
- ë‹¨ë°©í–¥ ë§¤í•‘ë§Œìœ¼ë¡œ í…Œì´ë¸”ê³¼ ê°ì²´ì˜ ì—°ê´€ê´€ê³„ ë§¤í•‘ì€ ì´ë¯¸ ì™„ë£Œëœë‹¤.
- ë‹¨ë°©í–¥ì„ ì–‘ë°©í–¥ìœ¼ë¡œ ë§Œë“¤ë©´ ë°˜ëŒ€ë°©í–¥ìœ¼ë¡œ ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ ê¸°ëŠ¥ì´ ì¶”ê°€ëœë‹¤.
- ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ë§¤í•‘í•˜ë ¤ë©´ ê°ì²´ì—ì„œ ì–‘ìª½ ë°©í–¥ì„ ëª¨ë‘ ê´€ë¦¬í•´ì•¼ í•œë‹¤.


